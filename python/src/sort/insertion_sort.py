"""
挿入ソートモジュール

このモジュールは、各要素をソート済み部分の適切な位置に挿入することで
リストをソートする挿入ソートアルゴリズムを実装しています。
"""

from typing import List, Any


def insertion_sort(data: List[Any]) -> List[Any]:
    """
    挿入ソートを用いてリストを昇順にソートします。
    （リスト自体を変更します - 破壊的メソッド）
    
    挿入ソートは、トランプのカードを手に取って並べ替えるような
    直感的なソートアルゴリズムです。
    各要素を、既にソート済みの部分の適切な位置に「挿入」していきます。
    
    アルゴリズムの手順:
    1. 2番目の要素から順に処理を開始
    2. 現在の要素（key）を取り出す
    3. keyより大きいソート済み部分の要素を右にずらす
    4. keyを適切な位置に挿入
    5. リストの末尾まで2-4を繰り返す
    
    時間計算量: 
    - 最悪/平均: O(n²)
    - 最良: O(n) - リストが既にソート済みの場合
    空間計算量: O(1) - 追加のメモリをほとんど使用しない
    安定性: 安定（同じ値の要素の相対的な順序が保持される）
    
    小さなリストや、ほぼソート済みのリストに対して効率的です。
    
    Args:
        data (List[Any]): ソート対象のリスト
        
    Returns:
        List[Any]: ソートされたリスト（元のリストと同じ参照）
    """
    # リストの要素数を取得
    n = len(data)
    
    # 外側のループ: 2番目の要素（インデックス1）から開始
    # 最初の要素（インデックス0）は、1要素だけのソート済みリストとみなす
    for i in range(1, n):
        # 挿入する要素（key）を保存
        # この要素をソート済み部分の適切な位置に挿入する
        key = data[i]
        
        # ソート済み部分の末尾のインデックス
        j = i - 1
        
        # ソート済み部分を右から左に走査
        # keyより大きい要素を右に1つずつシフト
        while j >= 0 and data[j] > key:
            # 要素を右に1つシフト
            data[j + 1] = data[j]
            # 次の位置へ移動
            j -= 1
        
        # keyを適切な位置に挿入
        # j+1 の位置が、keyが入るべき場所
        data[j + 1] = key
            
    # ソート済みのリストを返す
    return data
